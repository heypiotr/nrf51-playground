<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>nRF5 SDK v12.3.0: ADC</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="extra_stylesheet_offline.css" rel="stylesheet" type="text/css"/>
<link href="nordic.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0" width="100%" class="blank">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Nordic Semiconductor" src="nordic_small.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">nRF5 SDK
   &#160;<span id="projectnumber">v12.3.0</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
<table cellspacing="0" cellpadding="0" class="blank">
<tr>
<td class="doclinkintro">Choose documentation:</td>
<td class="doclinks" id="nrf5"><a href="../nrf5/index.html">nRF5 SDK</a></td>
<td class="doclinks" id="s130"><a href="../s130/index.html">S130 SoftDevice API</a></td>
<td class="doclinks" id="s132"><a href="../s132/index.html">S132 SoftDevice API</a></td>
<td class="doclinks" id="s212"><a href="../s212/index.html">S212 SoftDevice API</a></td>
<td class="doclinks" id="s332"><a href="../s332/index.html">S332 SoftDevice API</a></td>
</tr>
</table>
<script>
var url=window.location.href.split("/").reverse()[1];
var validLinks= ["nrf5","s130","s132","s212","s332"];
var index;
for (index = 0; index < validLinks.length; ++index) {
   if ( url.indexOf(validLinks[index]) !== -1 ) {
      document.getElementById(validLinks[index]).setAttribute('class', 'doclinks docselected');
   };
};
</script>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('hardware_driver_adc.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">ADC </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div class="whichnRF nRF51"><span>This information applies to the <b>nRF51 Series</b> only.</span></div><p>The ADC driver includes two layers: the hardware access layer (HAL) and the driver layer (DRV).</p>
<p>The hardware access layer (HAL) provides basic APIs for accessing the registers of the analog-to-digital converter (ADC). See the API documentation for the <a class="el" href="group__nrf__drv__adc.html">ADC driver</a> for details.</p>
<p>The driver layer provides APIs on a higher level than the HAL. The driver can perform software emulated scanning, buffer handling, and has two modes of data transfer: blocking and non-blocking. See the API documentation for the <a class="el" href="group__nrf__drv__adc.html">ADC driver</a> for details.</p>
<p>The <a class="el" href="nrf_dev_adc_example.html">ADC Example</a> provides sample code that you can use to quickly get started.</p>
<h1><a class="anchor" id="hardware_driver_adc_init"></a>
Initialization</h1>
<p>Initialize the driver by calling <a class="el" href="group__nrf__drv__adc.html#gac646f3615f94f85333f6818aa7b6d2e1">nrf_drv_adc_init</a>. The configuration includes the interrupt priority level. An event handler can be provided during the initialization. If no event handler is provided, the driver operates in blocking mode.</p>
<h1><a class="anchor" id="hardware_driver_adc_using"></a>
Using the ADC driver</h1>
<p>The driver works with channels. Channels are objects with a conversion configuration and pin details. Multiple channels can be enabled at once; if more than one channel is enabled, they are linked together and scanned. The channel object content is manipulated by the driver, so it cannot be an automatic variable.</p>
<p>Use the function <a class="el" href="group__nrf__drv__adc.html#ga13ce7b2be107538728ed74c6f647903d">nrf_drv_adc_sample_convert</a> to get a single sample on a single channel. This function configures ADC, starts sampling, and blocks until the conversion is completed. The channel does not need to be enabled to perform sampling on it.</p>
<p>Use <a class="el" href="group__nrf__drv__adc.html#gaab69dd321ead98713c573c663a12bfa5">nrf_drv_adc_buffer_convert</a> to perform multiple conversions on multiple channels. This function sets up ADC but does not trigger a conversion. Conversions can be triggered either by calling <a class="el" href="group__nrf__drv__adc.html#gadf8f5157651ccf64a60a1fd6584d08ea">nrf_drv_adc_sample</a> or with PPI. The task address for PPI can be retrieved through the driver by calling <a class="el" href="group__nrf__drv__adc.html#ga8df8234ffdaadac98119a0efe5dcb35a">nrf_drv_adc_start_task_get</a>.</p>
<p>When a single sample is triggered, the driver starts a conversion on all enabled channels in a chain. In the ADC interrupt context, ADC is reconfigured and conversion is triggered until the last channel in a chain is reached or the buffer is full. The application must adjust the sampling frequency, taking into account the ADC conversion time and interrupt latency, because the ADC interrupt must be handled before the next conversion can be started.</p>
<p>If no event handler was provided during initialization, <a class="el" href="group__nrf__drv__adc.html#gaab69dd321ead98713c573c663a12bfa5">nrf_drv_adc_buffer_convert</a> works in blocking mode. This means that it will not return until the buffer is full. If <a class="el" href="group__nrf__drv__adc.html#gadf8f5157651ccf64a60a1fd6584d08ea">nrf_drv_adc_sample</a> is used to trigger sampling, it must be called from a different context.</p>
<p>Channels are enabled by calling <a class="el" href="group__nrf__drv__adc.html#ga96f430e9fb84484c758ff8a0091a5015">nrf_drv_adc_channel_enable</a> and disabled by calling <a class="el" href="group__nrf__drv__adc.html#ga17dcd846dd86e758f41ffa92cea3275b">nrf_drv_adc_channel_disable</a>. Use the macro <a class="el" href="group__nrf__drv__adc.html#ga7cdaaf9645ea8bc89ee138da0aa10511">NRF_DRV_ADC_DEFAULT_CHANNEL</a> to initialize a channel object to its default settings.</p>
<p>The following example shows how to initialize the channel and start conversion to a buffer. Conversion is non-blocking because an event handler is provided during initialization. Channel variables are static. After conversion is set up, <a class="el" href="group__nrf__drv__adc.html#gadf8f5157651ccf64a60a1fd6584d08ea">nrf_drv_adc_sample</a> is called and a conversion chain is triggered. Only two samples are requested, so the user handler is called when conversion on the second channel is completed.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> adc_event_handler(​nrf_drv_adc_evt_t <span class="keyword">const</span> * p_event)</div>
<div class="line">{</div>
<div class="line">    </div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    nrf_adc_value_t buffer[2];</div>
<div class="line">    <a class="code" href="group__sdk__error.html#gaf6c20fb483036617204f12e99e0b997b" title="API Result.">ret_code_t</a> ret = <a class="code" href="group__nrf__drv__adc.html#gac646f3615f94f85333f6818aa7b6d2e1" title="Function for initializing the ADC.">nrf_drv_adc_init</a>(NULL, adc_event_handler);</div>
<div class="line"></div>
<div class="line">    <span class="keyword">static</span> <a class="code" href="structnrf__drv__adc__channel__s.html" title="ADC channel.">nrf_drv_adc_channel_t</a> channel1 = <a class="code" href="group__nrf__drv__adc.html#ga7cdaaf9645ea8bc89ee138da0aa10511" title="Macro for initializing the ADC channel with the default configuration.">NRF_DRV_ADC_DEFAULT_CHANNEL</a>(<a class="code" href="group__nrf__adc__hal.html#gga7efdf26b2463b9e15aaaaffa76ee224fad7bf1e82e2f6b17aeea2c0eca71eff46">NRF_ADC_CONFIG_INPUT_1</a>); <span class="comment">//note keyword &#39;static&#39;</span></div>
<div class="line">    <span class="keyword">static</span> <a class="code" href="structnrf__drv__adc__channel__s.html" title="ADC channel.">nrf_drv_adc_channel_t</a> channel2 = <a class="code" href="group__nrf__drv__adc.html#ga7cdaaf9645ea8bc89ee138da0aa10511" title="Macro for initializing the ADC channel with the default configuration.">NRF_DRV_ADC_DEFAULT_CHANNEL</a>(<a class="code" href="group__nrf__adc__hal.html#gga7efdf26b2463b9e15aaaaffa76ee224fa0a4dde6a4dea2ed0dcd649b018bd87c0">NRF_ADC_CONFIG_INPUT_2</a>); <span class="comment">//note keyword &#39;static&#39;</span></div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__nrf__drv__adc.html#ga96f430e9fb84484c758ff8a0091a5015" title="Function for enabling an ADC channel.">nrf_drv_adc_channel_enable</a>(&amp;channel1);</div>
<div class="line">    <a class="code" href="group__nrf__drv__adc.html#ga96f430e9fb84484c758ff8a0091a5015" title="Function for enabling an ADC channel.">nrf_drv_adc_channel_enable</a>(&amp;channel2);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Start sampling to buffer.</span></div>
<div class="line">    ret = <a class="code" href="group__nrf__drv__adc.html#gaab69dd321ead98713c573c663a12bfa5" title="Function for converting data to the buffer.">nrf_drv_adc_buffer_convert</a>(buffer,2);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Trigger conversion on both enabled channels.</span></div>
<div class="line">    <a class="code" href="group__nrf__drv__adc.html#gadf8f5157651ccf64a60a1fd6584d08ea" title="Function for starting ADC sampling.">nrf_drv_adc_sample</a>();</div>
<div class="line">}</div>
</div><!-- fragment --><p>At any time, you can call <a class="el" href="group__nrf__drv__adc.html#ga2e50fc67d648b760d9bea430d23a6a8b">nrf_drv_adc_is_busy</a> to check if the driver is busy. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<div id="nav-path" class="topicfooter">
<a href="mailto:docfeedback@nordicsemi.no?subject=Documentation%20feedback" id="maillink">Documentation feedback</a> | <a href="https://devzone.nordicsemi.com/questions/" target="_blank">Developer Zone</a> | <a href="http://response.nordicsemi.com/subscribe-to-our-newsletters" target="_blank">Subscribe</a> | Updated <span id="date"/>
<script>
var date = new Date("Mon May 8 2017" + " UTC");
document.getElementById("date").innerHTML = date.toJSON().slice(0, 10);
var url=window.location.href.split("?")[0];
var filename=url.substring(url.lastIndexOf('/')+1);
document.getElementById("maillink").href = "mailto:docfeedback@nordicsemi.no?subject=Documentation%20feedback"+decodeURIComponent("%26")+"body=File%20name%3A%20"+encodeURIComponent(filename);
</script>
</div>
</body>
</html>
